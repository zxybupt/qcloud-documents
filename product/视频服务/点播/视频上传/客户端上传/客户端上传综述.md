<!-- ## 简介

随着终端用户个性化的需求愈加强烈，简单的文字交互已经不能满足用户的分享诉求。腾讯云点播支持用户将客户端上的视频文件直接上传到云端，并与点播的其它业务功能（比如转码、截图、防盗链等）无缝结合。

## 上传流程

![](//mc.qcloudimg.com/static/img/1cb47b70ba7ab12ddf161f9576ca6849/image.png)

上图为客户端上传流程示意图，主要有4个参与对象，分别是：客户端、APP 服务器、腾讯云点播系统 VOD 和腾讯云存储系统 COS。下面对流程图中的各步骤进行详细说明。

### 第一步：客户端从 APP 服务器获取上传签名

客户端上传文件到腾讯云之前，VOD 需要检查客户端的上传行为是否已获得 APP 服务器的授权。因此，客户端必须先从 APP 服务器获取上传签名，并在请求上传信息时将该签名传递给 VOD。VOD 校验签名，只有在校验结果为“签名合法”的情况下，才允许客户端进行后续上传操作。

APP 服务器生成签名的方式参照[客户端上传签名](/document/product/266/9221)。

***注意***：***千万不要*** 将 API 密钥（即 Secret ID 和 Secret Key）直接暴露给客户端，该信息一旦泄露可能引发严重的安全问题。API 密钥应只由 APP 服务器保管。

### 第二步：客户端向 VOD 发起上传

客户端将文件上传到 COS 前，需要知道目标 COS Bucket、路径等信息。客户端向 VOD 发起上传，获取上传 COS 所需的信息。VOD 签名校验通过后为其分配上传信息。

客户端请求上传信息时，可以选择只上传视频（只请求视频文件的上传信息），或者同时上传视频和封面（同时请求视频文件和封面文件的上传信息）。

### 第三步：客户端向 COS 上传文件

客户端根据之前发起上传时获取的上传信息，调用 COS 的上传接口完成文件上传。

### 第四步：客户端向 VOD 确认上传

客户端成功上传文件到 COS 后，需要向 VOD 发起确认请求。收到确认上传的请求后，VOD 将返回视频的 fileId、视频播放地址、封面图片地址（如果有）等信息，并按照用户的要求对上传后的视频进行转码、打水印、截图等操作。

## 上传方式

### SDK

为了方便用户开发客户端上传功能，云点播提供了多种平台的 SDK：

* [Android SDK](/document/product/266/9237)
* [iOS SDK](/document/product/266/9238)
* [Web SDK](/document/product/266/9239)

SDK 封装了客户端和 VOD、COS 交互的细节，上传流程中的第二步到第四步，只需调用 SDK 中的一个接口即可全部完成。因此 ***强烈推荐*** 用户在 APP 中集成点播提供的 SDK 来实现客户端上传。 -->




## 客户端视频上传综述

所谓客户端视频上传，是指APP的**最终用户**将本地APP上视频上传到点播平台。与服务端上传相比，客户端上传一般是由APP的最终用户执行的，故而APP**不**应该也**不**可以将API秘钥(即SecretId和SecretKey)暴露给客户端。

客户端上传的大致流程如下图所示。其中，1、2步是由APP服务端发起的，3、4、5步是由点播后台发起的。

TODO：架构图。



### 获取签名

对应客户端视频上传业务逻辑图中的第1步。

点播服务端需要对所有视频上传请求进行校验，但APP又不应该将API秘钥直接暴露给客户端。因此客户端在发起视频上传之前，需要在APP后台申请上传签名。除了用作鉴权凭证之外，对视频的属性设置、视频上传完成之后的处理方式等，也都可以在上传签名中设置。

参见：[客户端上传签名](/document/product/266/9221)。

### 使用SDK上传视频

对应客户端视频上传业务逻辑图中的第2步。

点播提供了iOS/Android/Web三端的视频上传SDK：

1. [iOS SDK](/document/product/266/7836)；
2. [Android SDK](/document/product/266/7837)；
3. [Web SDK](/document/product/266/7938)。

## 上传时指定封面

三端SDK均支持在上传视频的同时，额外上传一张本地图片作为封面。详见三端SDK文档。

## 本地视频编辑

TODO：

## 断点续传与秒传

TODO：等待三端SDK均完成断点续传相关文档。

## 目标上传园区

TODO：等待园区相关文档完善。

### 上传到就近园区

TODO：等待园区相关文档完善。

### 上传到指定园区

TODO：等待园区相关文档完善。


## 视频上传时指定处理方式

TODO：等待视频处理综述文档完善。

## 视频上传事件通知

对应客户端视频上传业务逻辑图中的第3步。

视频上传成功之后，如果APP配置了视频上传完成通知，则点播会依照APP配置的方式发起事件通知。

参见：[事件通知-视频上传完成](/document/product/266/7830)。

## 安全相关

### 单次有效签名

TODO：@jianguoxu完善文档。如果现状尚不足以对外，完善接口之后对外。

### 限制用户上传文件大小
暂不支持，敬请期待。